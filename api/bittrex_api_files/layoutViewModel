function socketIndicator(){"use strict";var n=this;n.connectionStatus=ko.observable("Disconnected");n.displayStatus=ko.pureComputed(function(){return"Socket Status = "+n.connectionStatus()});var t=function(){n.connectionStatus("Connected")},i=function(){n.connectionStatus("Slow")},r=function(){n.connectionStatus("Reconnecting")},u=function(){n.connectionStatus("Disconnected")};$("#event-store").on("socket-start",t);$("#event-store").on("socket-slow",i);$("#event-store").on("socket-reconnecting",r);$("#event-store").on("socket-connected",t);$("#event-store").on("socket-disconnected",u)}function marketMenu(){"use strict";function f(t){var i=ko.utils.arrayFilter(n.markets(),function(n){return n.baseCurrency==t&&n.isActive()});return r(i)}function e(){var t=ko.utils.arrayFilter(n.markets(),function(n){return n.isFiat()&&n.isActive()});return r(t)}function r(t){var i,r,u,f;return n.filter&&n.filter()&&(t=$.grep(t,function(t){return t.marketCurrency.toLowerCase().indexOf(n.filter().toLowerCase())>-1||t.marketCurrencyName.toLowerCase().indexOf(n.filter().toLowerCase())>-1})),n.selectedSort&&n.selectedSort()&&(i=n.selectedSort().property,r=n.selectedSort().isObservable?function(n,t){return n[i]()<t[i]()?-1:n[i]()>t[i]()?1:n[i]()==t[i]()?0:0}:function(n,t){return n[i]<t[i]?-1:n[i]>t[i]?1:n[i]==t[i]?0:0},u=function(n,t){return r(t,n)},i=="created"&&(r=function(n,t){return n.created().isBefore(t.created())?-1:n.created().isAfter(t.created())?1:n.created().isSame(t.created())?0:0}),f=n.selectedSort().asc?r:u,t=t.sort(f)),n.selectedRows&&n.selectedRows()&&n.selectedRows().count&&(t=t.slice(0,n.selectedRows().count*n.columns())),t}function o(){var t;$.cookie("marketFilter")&&n.filter($.cookie("marketFilter"));$.cookie("marketSort")&&(t=ko.utils.arrayFirst(n.availableSort,function(n){return n.property==$.cookie("marketSort")}),t&&n.selectedSort(t));$.cookie("marketRows")&&(t=ko.utils.arrayFirst(n.availableRows,function(n){return n.count==$.cookie("marketRows")}),t&&n.selectedRows(t))}function s(i){for(var f,u=i.serviceData.Deltas,r=0;r<u.length;r++)u[r].marketName=u[r].MarketName,n.markets.contains(u[r])&&(f=n.markets.index()[u[r].MarketName],n.markets()[f].updateSummary(u[r]));t();n.markets.notifySubscribers()}function h(i){for(var u,f=i.serviceData,r=0;r<n.markets().length;r++)n.markets()[r].dispose();u=$.map(f,function(n){return new marketSummaryEntry(n)});n.markets(u);t();n.markets.notifySubscribers()}function t(){n.marketsBtcRows(n.marketsRows(f("BTC")));n.marketsFiatRows(n.marketsRows(e()))}function i(n){switch(n){case"LIMIT_SELL":case"MARKET_SELL":return"Sell";case"LIMIT_BUY":case"MARKET_BUY":return"Buy"}return"Unknown"}var n=this,u;n.columns=ko.observable(6);n.markets=ko.observableArray([]).indexed("marketName");n.marketsBtcRows=ko.observableArray([]);n.marketsFiatRows=ko.observableArray([]);n.totalBtc=ko.pureComputed(function(){for(var i=0,t=0;t<n.markets().length;t++)n.markets()[t].baseCurrency=="BTC"&&(i+=n.markets()[t].baseVolume());return i});n.totalEth=ko.pureComputed(function(){for(var i=0,t=0;t<n.markets().length;t++)n.markets()[t].baseCurrency=="ETH"&&(i+=n.markets()[t].baseVolume());return i});n.displayTotalBtc=ko.pureComputed(function(){return"Total BTC Volume = "+n.totalBtc().toFixed(4)},this);n.displayTotalEth=ko.pureComputed(function(){return"Total ETH Volume = "+n.totalEth().toFixed(4)},this);n.columns.subscribe(function(){t()});n.marketsRows=function(t){var f=[],i,e,r=!1,u,o;for(n.columns(),e=n.columns(),u=0,o=t.length;u<o;u++)u%e==0&&(i&&(r=!r,f.push(i)),i=[]),i.push(t[u].isEven(r)),r=!r;return i&&f.push(i),f};n.resize=function(t){switch(t){case"xs":n.columns(2);break;case"sm":n.columns(4);break;case"md":n.columns(5);break;case"lg":n.columns(6)}};n.availableSort=[{property:"marketName",sortName:"Name",asc:!0,isObservable:!1},{property:"change",sortName:"Percent Change",asc:!1,isObservable:!0},{property:"last",sortName:"Last Price",asc:!1,isObservable:!0},{property:"baseVolume",sortName:"Volume",asc:!1,isObservable:!0},{property:"created",sortName:"Newest",asc:!1,isObservable:!0},{property:"created",sortName:"Oldest",asc:!0,isObservable:!0}];n.selectedSort=ko.observable(n.availableSort[3]);n.selectedSort.subscribe(function(n){$.cookie("marketSort",n.property,{path:"/"});t()});n.availableRows=[{sortName:"All",count:null},{sortName:"2",count:2},{sortName:"3",count:3},{sortName:"4",count:4},{sortName:"5",count:5},{sortName:"6",count:6},];n.selectedRows=ko.observable(n.availableRows[2]);n.selectedRows.subscribe(function(n){$.cookie("marketRows",n.count,{path:"/"});t()});n.filter=ko.observable();n.filter.subscribe(function(n){$.cookie("marketFilter",n,{path:"/"});t()});u=function(t){var f,e;if(t.serviceData){var h=t.serviceData,r=h.Order,c=n.markets.index()[r.Exchange],u=n.markets()[c],o=u&&u.urlPath||"",s=u&&u.imgPath||null;switch(h.Type){case 1:f="Your "+i(r.OrderType)+" order has partially filled "+(r.Quantity-r.QuantityRemaining).toFixed(8)+" out of "+r.Quantity.toFixed(8)+" units in "+r.Exchange+" at "+r.Limit.toFixed(8)+" per unit.";e=u.marketCurrency+" "+i(r.OrderType)+" Partially Filled";showAlert(f,"success",e,o,s);break;case 2:f="Your "+i(r.OrderType)+" order of "+r.Quantity.toFixed(8)+" units in "+r.Exchange+" at "+r.Limit.toFixed(8)+" per unit has processed.";e=u.marketCurrency+" "+i(r.OrderType)+" Filled";showAlert(f,"success",e,o,s);break;case 3:f="Your "+i(r.OrderType)+" order of "+r.Quantity.toFixed(8)+" units in "+r.Exchange+" at "+r.Limit.toFixed(8)+" per unit has cancelled.";e=u.marketCurrency+" "+i(r.OrderType)+" Cancelled";showAlert(f,"success",e,o,s)}}};o();$("#event-store").on("data-update-summaries",s);$("#event-store").one("data-query-summaries",h);$("#event-store").on("data-update-orders",u)}function navigationMenu(){"use strict";var n=this,t;n.bitcoinUsd=ko.observable(0);n.displayBitcoinUsd=ko.pureComputed(function(){return"1 BTC = $"+n.bitcoinUsd().toFixed(4)},this);t=function(t){t&&t.serviceData.bpi&&n.bitcoinUsd(t.serviceData.bpi.USD.rate_float)};$("#event-store").on("data-update-bitcoinPrice",t)}function layoutViewModel(){"use strict";var n=this;n.menu=new marketMenu;n.navigation=new navigationMenu;n.socket=new socketIndicator;n.resize=function(t){n.menu.resize(t)}}$(function(){"use strict";function t(){screen_xs_size()?n.resize("xs"):screen_sm_size()?n.resize("sm"):screen_md_size()?n.resize("md"):screen_lg_size()&&n.resize("lg")}function r(){$("#alert-news-text").length&&$.getJSON("/news/GetLatestAlert",function(n){n.Alert&&($("#alert-news").show(),$("#alert-news-text").text(n.Title))})}var n=new layoutViewModel,i;document.getElementById("layout-navigation")!=null&&ko.applyBindings(n,document.getElementById("layout-navigation"));document.getElementById("header-navigation")!=null&&ko.applyBindings(n,document.getElementById("header-navigation"));document.getElementById("footer-navigation")!=null&&ko.applyBindings(n,document.getElementById("footer-navigation"));i=_.debounce(t,500);window.addEventListener("resize",i,!1);$(window).load(t);$("#layout-navigation").sticky&&$("#layout-navigation").sticky({topSpacing:50});r()})